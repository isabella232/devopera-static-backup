<svg xmlns="http://www.w3.org/2000/svg" xmlns:toka="http://www.zuccaralloo.de/toka" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" onload="init(evt)" zoomAndPan="disable"><desc>tokarama: click-n-jump game written by Heiko Niemann in 2004</desc><title>tokarama</title><style type="text/css">@font-face{font-family:&apos;Verdana64&apos;;src:url(data:;base64,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)}@font-face{font-family:&apos;VerdanaBold64&apos;;src:url(data:;base64,T1RUTwACACAAAQAAQ0ZGIOoyAt8AAAAsAAADyGNtYXAB4AHtAAAD9AAAAFwBAAQCAAEBAQ1WZXJkYW5hLUJvbGQAAQEBNfgbAfgUBPsq/D0cDagcCAEFHqAASIKBJf+Lix6gAEiCgSX/i4sMB/cYD/cnEPcpEZL6VRIAAQEBMFZlcmRhbmEgaXMgYSB0cmFkZW1hcmsgb2YgTWljcm9zb2Z0IENvcnBvcmF0aW9uAAAAAAEAQgBMAE4AUABTAFUAAAAIAgABACEAIgDsARYBuAJuArcDGPjR95QWHAYAHAYAHPoABxz6gPcUFRwFABwFABz7AAYODiD55ve5Ffd+B1qHV4ZShFKEYIJugmeAcHp4dgh4dYFuaBp0jXiPfB6PfJV9m36afp6BoIUIhKCtiLgbr7CSmrAfsJqrnqejCPtCBHh8c3pudm52cHtyf2h7Zn9lhAiDZWGHXhsgMqzNQx9DzWff8hrdnc6wvx6wv7+0zqnOqd2g7pjumPGU9ZEIkQfJcrZYox6iWEGXKBtQS4F2SB9Idlp6boAIavejBrGVyZfhmQiY4OGS4Rv3YfcobEzmH+ZMuCj7Gxr9kPv5Bw4mHAVSFvw3BvvP+H0p+wsF/Ab7/BwGFPf8/jUH+Bj4hAX4Mwb8KPx4BQ75SBwE9PmwFf2w+/74xQfCirmIsh6IsYSqf6N/o3mdc5YIlnJpkF8baGiEfWofanxtfHB7CP2w+/z69/f8+xAHybzGscSmCKbEyZnQG9XMe2rEH8Rqt1qrS9PI0brPrgiuz86czBv3DehnQsofykKqI/sdGv1v+/74xQfCirqJsR6IsYSqf6OAo3mdcpYIlnJpkF4bbW6GgW4fboBoemJzCA5GHAUm+MUV+01V+yUgIR4g+wD7K1b7Vxv7V/srwPYgH/sA9VX3JfdNGvdOwfcm9wH1HvX3APcrwPdVG/dY9yxWIPYf9iDA+yX7TRr8T/ulFaKona2XtAiWs5HD0hrNhcJ/uB5/uHqudqZ2pnGfbZYIlm1rkWgbaG2GgnAfcIJxeHJvdXF6Z35eCH5ehFJGGk6RVpZeHpZenGahcKBxpXipfwh/qK2FsRusqpGWqR+olqSdoKUIDvxd+mz5oBVrBnyQco9pjgiOaW+MdBtYXYiEZB9khGCAXnsI/YT7/Pr39/z7OQfaz9C4xqIIocbBlrwbmJmLipsfm4qZipeKCA78svoMlRVkgWKDYIYIhWBWiEwb+yAjp8RHH0bEaez3HRr4ofso94j3KPfV9/z71ffl+4j75fwiB2SLaIxuHoxukHCVdJR0nHijfgh9oq6EuBueo4+Tqh+pk6CSl5IIqQYO+VAUHAXDFQAAAAEAAAADAAAADAAEAFAAAAAQABAAAwAAACAAYQBrAG0AbwByAHT//wAAACAAYQBrAG0AbwByAHT////h/6H/mP+X/5b/lP+TAAEAAAAAAAAAAAAAAAAAAAAA)}</style><script><![CDATA[

var svgDoc;

var xlinkNS = 'http://www.w3.org/1999/xlink';
var tokaNS = 'http://www.zuccaralloo.de/toka';

var tokData = 'xxxtttxxxxxxtttxxxxxxtttxxxtttttttttttttotttttttttttttxxxtttxxxxxxtttxxxxxxtttxxx';
var display = {t:'inline',o:'none',x:'none'};

var stats = {tok:[],n:[],e:[],s:[],w:[]};

var toka = {a:null,b:null,c:null,pos:null};

var animToken,dotts,tokas,board;

var direx = {
   n:{a:'m0,0 c -5,-25 50,-75 50,-60', b:'m0,0 l 50,-60', c:'.15 .05 .3 .1', d:-9},	
   s:{a:'m0,0 c-15,-10-50,15 -50,60',  b:'m0,0 l -50,60', c:'.15 .45 .6 .75',d: 9},	
   e:{a:'m0,0 c 25,-15 80,-10 100,20', b:'m0,0 l 100,20', c:'.15 .45 .6 .75',d: 1},	
   w:{a:'m0,0 c-35,-40-80,-45-100,-20',b:'m0,0 l-100,-20',c:'.15 .05 .3 .1', d:-1}
};

var coords = {x:0,y:0};


function init(e) 
{
	var i,j,tChar,xpos,ypos,disp,tran,newDot,newTok;
	
	svgDoc = e.target.ownerDocument;
	
	animToken = svgDoc.getElementById('animToken');
   	
	dotts = svgDoc.getElementById('dotts');
	tokas = svgDoc.getElementById('tokas');
	board = svgDoc.getElementById('board');
			
	for (var k=0; k<81; k++) 
	{
		i = Math.floor(k/9);
		j = k%9;
		
		tChar = tokData.charAt(k);
	
		stats.tok[k] = tChar;
	
		if (tChar!='x') 
		{
			xpos = 200 + j*50 - 25*i;
			ypos = 45 + j*10 + 30*i;
			tran = 'translate(' + xpos + ',' + ypos + ')';
			disp = display[tChar];
			
			newDot = svgDoc.createElementNS(null,'use');
			setAttr(newDot,null,'transform',tran);
			setAttr(newDot,xlinkNS,'href','#dot');
			dotts.appendChild(newDot);
			
			newTok = svgDoc.createElementNS(null,'use');
			setAttr(newTok,null,'id','t'+k);
			setAttr(newTok,tokaNS,'tid',k);
			setAttr(newTok,null,'display',disp);
			setAttr(newTok,null,'transform',tran);
			setAttr(newTok,xlinkNS,'href','#toka');
			tokas.appendChild(newTok);
		}
	}
	calculateScore();
	svgDoc.documentElement.addEventListener('mousemove', getCoords, false);
}

function getCoords(e) 
{
	coords.x = e.clientX;
	coords.y = e.clientY;
}

function startGame() 
{
	setAttr('introGroup',null,'display','none');
	setAttr('introHint',null,'display','none');
	setAttr('resetButton',null,'display','inline');
}

function resetBoard() 
{
	for (var k=0; k<81; k++)
	{
		tChar = tokData.charAt(k);

		stats.tok[k] = tChar;

		if(tChar!='x') setAttr('t'+k,null,'display',display[tChar]);
	}
	calculateScore();
}

function overToken(e) 
{
   var curToken = e.target; 
	if(e.target.correspondingUseElement) curToken = e.target.correspondingUseElement; 
		   
   toka.pos = curToken.getAttributeNS(null,'transform');
   setAttr('arrowGroup',null,'transform',toka.pos);      

	toka.a = parseInt(curToken.getAttributeNS(tokaNS,'tid'));
	
	setAttr('arrowN',null,'display',stats.n[toka.a]);
	setAttr('arrowS',null,'display',stats.s[toka.a]);
	setAttr('arrowE',null,'display',stats.e[toka.a]);
	setAttr('arrowW',null,'display',stats.w[toka.a]);
	setAttr('arrowGroup',null,'display','inline');
}

function overBoard()
{
	setAttr('arrowGroup',null,'display','none');
}

function setAnim(nwse)
{
   tokas.removeEventListener('mouseover',overToken,false);
	board.removeEventListener('mouseover',overBoard,false);
	setAttr('resetButton',null,'pointer-events','none');
	
	setAttr('arrowGroup',null,'display','none');
					
	toka.b = toka.a+direx[nwse].d;
	toka.c = toka.a+direx[nwse].d*2;
	
	setAttr('animToken',null,'path',direx[nwse].a);
   setAttr('animShadow',null,'path',direx[nwse].b);
   setAttr('animShadow',null,'keySplines',direx[nwse].c);
	
	setAttr('hopper',null,'transform',toka.pos);
	setAttr('hopper',null,'display','inline');
	setAttr('t'+toka.a,null,'display','none');
       
	animToken.beginElement();
}


function tokaLanding(evt) 
{		
   setAttr('t'+toka.c,null,'display','inline');
	setAttr('t'+toka.b,null,'display','none');
	setAttr('hopper',null,'display','none');
  	
	stats.tok[toka.a] = 'o';
   stats.tok[toka.b] = 'o';
   stats.tok[toka.c] = 't';

	setTimeout('calculateScore()',50);
}

function calculateScore() 
{
	var nbtok = 0;
	var nbmov = 0;
		
	for (k=0; k<81; k++)
	{
		i = Math.floor(k/9);
		j = k%9;
		
		stats.n[k] = 'none';
		stats.s[k] = 'none';
		stats.e[k] = 'none';
		stats.w[k] = 'none';
		
		if (stats.tok[k]=='t')
		{ 
			nbtok++;
			if (i>1 && stats.tok[k-9]=='t' && stats.tok[k-18]=='o') 
			{
				nbmov++; 
				stats.n[k] = 'inline';
			}
			if (j<7 && stats.tok[k+1]=='t' && stats.tok[k+ 2]=='o')
			{
				nbmov++; 
				stats.e[k] = 'inline';
			}
			if (i<7 && stats.tok[k+9]=='t' && stats.tok[k+18]=='o') 
			{
				nbmov++; 
				stats.s[k] = 'inline';
			}
			if (j>1 && stats.tok[k-1]=='t' && stats.tok[k- 2]=='o') 
			{
				nbmov++; 
				stats.w[k] = 'inline';
			}
		}
	}
		
	if (nbmov==0) 
	{
		if(nbtok<=1) {
			setAttr('winner',null,'display','inline');
			setAttr('almost',null,'display','none');
		}
		else {
			setAttr('winner',null,'display','none');
			setAttr('almost',null,'display','inline');
		}
		
		setAttr('intro',null,'display','none');
		setText('tokleft','tokas left: '+nbtok,null);
		setAttr('introGroup',null,'display','inline');
		setAttr('resetButton',null,'display','none');
				
		resetBoard();
	}
	else 
	{
		tokas.addEventListener('mouseover',overToken,false);
		board.addEventListener('mouseover',overBoard,false);
		setAttr('resetButton',null,'pointer-events','all');
		
		setAttr('shield',null,'cx',coords.x);
		setAttr('shield',null,'cy',coords.y);
		setAttr('shield',null,'display','inline');
		setTimeout("setAttr('shield',null,'display','none')",300);
	}
}

function setAttr(elem,ns,attr,val) 
{
	var target = (typeof elem == 'string') ? svgDoc.getElementById(elem) : elem;
	target.setAttributeNS(ns,attr,val);	
}

function setText(elem,val) 
{
	var target = (typeof elem == 'string') ? svgDoc.getElementById(elem) : elem;
	target.firstChild.data = val;
}

]]></script><defs><linearGradient id="gradTokas" gradientTransform="rotate(55)"><stop offset="20%" stop-color="#885"/><stop offset="90%" stop-color="#331"/></linearGradient><linearGradient id="gradDotts" gradientTransform="rotate(55)"><stop offset="20%" stop-color="#aaaaa0"/><stop offset="90%" stop-color="#bbbbb0"/></linearGradient><rect id="button" width="20" height="20" x="0" y="0" fill="#bdc8d2" fill-opacity="1" stroke="#444" stroke-width="1.5" rx="5"/><ellipse id="dot" cx="0" cy="0" fill="url(#gradDotts)" stroke="#999990" stroke-width="1" rx="17" ry="10"/><g id="tokaTop"><ellipse cx="1" cy="0" fill="#331" rx="17" ry="10"/><ellipse cx="0" cy="-4" fill="#eee" opacity=".9" rx="17" ry="10"/><ellipse cx="0" cy="-6" fill="url(#gradTokas)" rx="17" ry="10"/></g><g id="toka"><ellipse cx="5" cy="3" fill="#464646" opacity=".7" rx="17" ry="10"/><use xlink:href="#tokaTop"/></g><path id="arrowSymb" fill="maroon" stroke="maroon" stroke-linejoin="round" stroke-width="1" d="M0,-3.5 l-3.3,4.7 2.5,0 0,2.3 1.6,0 0,-2.3 2.5,0z" pointer-events="none"/><ellipse id="arrowBack" cx="0" cy="0" stroke="#600" stroke-width=".5" rx="6" ry="6"/><set attributeName="fill" begin="arrowN.mouseover;" end="arrowN.mouseout;arrowS.mouseover;arrowE.mouseover;arrowW.mouseover;arrowBase.mouseover;" to="#bee;" xlink:href="#backN"/><set attributeName="fill" begin="arrowS.mouseover;" end="arrowN.mouseover;arrowS.mouseout;arrowE.mouseover;arrowW.mouseover;arrowBase.mouseover;" to="#bee;" xlink:href="#backS"/><set attributeName="fill" begin="arrowE.mouseover;" end="arrowN.mouseover;arrowS.mouseover;arrowE.mouseout;arrowW.mouseover;arrowBase.mouseover;" to="#bee;" xlink:href="#backE"/><set attributeName="fill" begin="arrowW.mouseover;" end="arrowN.mouseover;arrowS.mouseover;arrowE.mouseover;arrowW.mouseout;arrowBase.mouseover;" to="#bee;" xlink:href="#backW"/><animateMotion id="animToken" begin="undefined" dur="1.5s" onend="tokaLanding()" xlink:href="#hoptop"/><animateMotion id="animShadow" begin="animToken.begin" calcMode="spline" dur="1.5s" xlink:href="#shadow"/><animateTransform attributeName="transform" begin="animToken.begin" dur="1.5s" type="scale" values="1;1.1;1.1;1" xlink:href="#shadow"/><animate attributeName="opacity" begin="animToken.begin" dur="1.5s" values=".7;.5;.5;.4;.4;.7" xlink:href="#shadow"/></defs><rect width="3000" height="3000" x="-1000" y="-1000" fill="#d3d0c3"/><svg width="100%" height="100%" viewBox="-30 10 680 450"><rect width="600" height="400" x="10" y="10" fill="none" stroke="#111" stroke-width="1" rx="0"/><rect width="600" height="400" x="11" y="11" fill="none" stroke="#eee" stroke-width="1" rx="0"/><g id="board"><g transform="translate(305,210) rotate(-5)"><ellipse cx="2" cy="16" fill="#777770" fill-opacity=".2" rx="281" ry="174"/><ellipse cx="0" cy="13" fill="#777770" fill-opacity=".5" rx="281" ry="174"/><ellipse cx="0" cy="11" fill="#664" fill-opacity=".9" stroke="#443" stroke-width="1" rx="280" ry="169"/><ellipse cx="0" cy="0" fill="#aaaa9d" stroke="#221" stroke-width=".8" rx="280" ry="170"/></g><g id="resetButton" display="none" onclick="resetBoard()" transform="translate(570 370)"><use xlink:href="#button"/><path fill="#444" d="M6,6 l8,0 0,8 -8,0 z"/></g></g><g id="hopper" display="none"><ellipse id="shadow" cx="5" cy="3" fill="#333" opacity=".8" rx="17" ry="10"/><use id="hoptop" xlink:href="#tokaTop"/></g><g id="arrowGroup" display="none" transform="translate(60,70)"><ellipse id="arrowBase" fill="#fff" opacity="0" rx="22.5" ry="18" transform="translate(0,-7) rotate(25)"/><g id="arrowN" onclick="setAnim('n')" transform="translate(4,-16) rotate(22)"><use id="backN" fill="#fcb;" xlink:href="#arrowBack"/><use xlink:href="#arrowSymb"/></g><g id="arrowE" onclick="setAnim('e')" transform="translate(14,-2) rotate(89)"><use id="backE" fill="#fcb;" xlink:href="#arrowBack"/><use xlink:href="#arrowSymb"/></g><g id="arrowW" onclick="setAnim('w')" transform="translate(-15,-12) rotate(-60)"><use id="backW" fill="#fcb;" xlink:href="#arrowBack"/><use xlink:href="#arrowSymb"/></g><g id="arrowS" onclick="setAnim('s')" transform="translate(-7,2) rotate(220)"><use id="backS" fill="#fcb;" xlink:href="#arrowBack"/><use xlink:href="#arrowSymb"/></g></g><g id="introGroup" font-family="Verdana64" font-size="12"><ellipse fill="#aaaa9d" stroke="none" rx="270" ry="160" transform="translate(305,210) rotate(-5)"/><use transform="translate(480,200)" xlink:href="#dot"/><use transform="translate(400,260)" xlink:href="#toka"/><use transform="translate(440,230)" xlink:href="#toka"/><g id="introHint" pointer-events="none"><path fill="#443" stroke="none" d="M0,0 l-6,0 0,6z" transform="translate(100,90) translate(334,170) rotate(-25)"/><path fill="#443" stroke="none" d="M0,0 l6,0 0,6z" transform="translate(100,90) translate(341,163) rotate(-50)"/><text x="345" y="178" fill="#443" font-family="Verdana64" font-size="8" transform="translate(100,90)">tokas</text></g><g fill="#443" font-family="Verdana64" font-size="13" pointer-events="none"><text id="intro" transform="translate(190,90)"><tspan x="0" y="20" font-family="VerdanaBold64" font-size="18">tokarama</tspan> <tspan x="0" y="60">click-n-jump</tspan> <tspan x="0" y="90">tokas: remove all but one</tspan> <tspan x="0" y="120">how: jump over toka</tspan> <tspan x="0" y="170">have fun</tspan></text><text id="winner" display="none" transform="translate(190,100)"><tspan x="0" y="70">you did it!</tspan> <tspan x="0" y="120">feel free to play again</tspan></text><text id="almost" display="none" transform="translate(190,100)"><tspan x="0" y="120">try again</tspan></text></g><g onclick="startGame()" transform="translate(190,300)"><use xlink:href="#button"/><path fill="#444" d="M7,5 l8,5 -8,5 z"/></g></g></svg><circle id="shield" cx="0" cy="0" r="50" fill="#fff" fill-opacity="0" display="none"/></svg>